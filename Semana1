from google.colab import drive
drive.mount('/content/drive')
import pandas as pd
import numpy as np
from math import sin, cos, radians
import plotly.express as px


collar = pd.read_csv('/content/drive/My Drive/PIC/collar.csv')
survey = pd.read_csv('/content/drive/My Drive/PIC/survey.csv')
assay = pd.read_csv('/content/drive/My Drive/PIC/assay.csv')
lista_coordenadas = []
for i in collar['BHID'].unique():
  buffer_survey = survey[survey['BHID'] == i]
  buffer_collar = collar[collar['BHID'] == i]
  X = []
  Y = []
  Z = []

  X.append(buffer_collar['XCOLLAR'].values[0])
  Y.append(buffer_collar['YCOLLAR'].values[0])
  Z.append(buffer_collar['ZCOLLAR'].values[0])


  buffer_survey = buffer_survey.reset_index(drop=True)
  tamanho_survey = len(buffer_survey.index)
  for j in range(tamanho_survey-1):
    comprimento_segmento = buffer_survey.loc[j+1, "AT"] - buffer_survey.loc[j, "AT"]
    comprimento_horizontal = comprimento_segmento * cos(radians(buffer_survey.loc[j,'DIP']))
    X.append(X[j] + comprimento_horizontal * sin(radians(buffer_survey.loc[j, 'AZ'])))
    Y.append(Y[j] + comprimento_horizontal * cos(radians(buffer_survey.loc[j, 'AZ'])))
    Z.append(Z[j] - comprimento_segmento * sin(radians(buffer_survey.loc[j,'DIP'])))

  lista_coordenadas.append(pd.DataFrame(list(zip([i]*tamanho_survey,X, Y, Z)), columns=['BHID','X', 'Y', 'Z']))

coordenadas = pd.concat(lista_coordenadas)
print(coordenadas)



fig = px.line_3d(coordenadas, x="X", y="Y",  z="Z",  line_group ="BHID", hover_name = 'BHID')
fig.show()
